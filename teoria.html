<!DOCTYPE html>
<html lang="es" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Material de clase ‚Äì Teor√≠a (12 Unidades)</title>
  <meta name="description" content="Material de teor√≠a por unidades. Navegaci√≥n, buscador y modo oscuro/claro." />

  <style>
    :root{
      --font-main: system-ui, -apple-system, "Segoe UI", sans-serif;
      --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --r-lg: 22px; --r-md: 14px; --r-pill: 999px;
    }
    :root[data-theme="dark"]{
      --bg: radial-gradient(circle at top, #0b1020 0, #020617 60%);
      --panel: rgba(2, 6, 23, 0.85);
      --card: rgba(15, 23, 42, 0.6);
      --card2: rgba(15, 23, 42, 0.78);
      --text: #e5e7eb;
      --muted: #9ca3af;
      --border: rgba(148, 163, 184, 0.28);
      --border2: rgba(148, 163, 184, 0.45);
      --accent: #22c55e;
      --accent2: rgba(34, 197, 94, 0.18);
      --shadow: 0 26px 70px rgba(0,0,0,0.55);
      --codebg: #020617;
    }
    :root[data-theme="light"]{
      --bg: radial-gradient(circle at top, #e8fff3 0, #ffffff 55%);
      --panel: rgba(255, 255, 255, 0.92);
      --card: rgba(255, 255, 255, 0.9);
      --card2: rgba(248, 250, 252, 0.95);
      --text: #0f172a;
      --muted: #64748b;
      --border: rgba(148, 163, 184, 0.35);
      --border2: rgba(148, 163, 184, 0.55);
      --accent: #16a34a;
      --accent2: rgba(22, 163, 74, 0.14);
      --shadow: 0 18px 45px rgba(148,163,184,0.35);
      --codebg: #f1f5f9;
    }

    *{ box-sizing:border-box; margin:0; padding:0; }
    body{
      font-family: var(--font-main);
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding: 1.4rem;
      display:flex;
      justify-content:center;
    }

    .app{
      width: 100%;
      max-width: 1200px;
      border: 1px solid var(--border);
      border-radius: var(--r-lg);
      box-shadow: var(--shadow);
      overflow:hidden;
      background: var(--panel);
      backdrop-filter: blur(14px);
    }

    header{
      padding: 1.15rem 1.2rem 1rem;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(135deg, var(--accent2), transparent 55%);
    }
    .topbar{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:1rem;
      flex-wrap:wrap;
    }
    .brand{
      display:flex;
      gap:0.75rem;
      align-items:center;
    }
    .logo{
      width: 42px; height: 42px;
      border-radius: 999px;
      border: 2px solid var(--accent);
      display:flex; align-items:center; justify-content:center;
      font-weight: 750;
      font-family: var(--font-mono);
      color: var(--accent);
      background: var(--card2);
    }
    h1{
      font-size: 1.25rem;
      letter-spacing: 0.02em;
      margin-bottom: 0.2rem;
    }
    .subtitle{
      color: var(--muted);
      font-size: 0.9rem;
      max-width: 60ch;
      line-height: 1.35;
    }

    .actions{
      display:flex;
      gap:0.55rem;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .btn{
      border: 1px solid var(--border);
      background: var(--card);
      color: var(--text);
      border-radius: var(--r-pill);
      padding: 0.35rem 0.75rem;
      font-size: 0.82rem;
      cursor:pointer;
      display:inline-flex;
      gap:0.35rem;
      align-items:center;
      transition: transform .08s ease, border-color .12s ease;
      user-select:none;
      white-space: nowrap;
    }
    .btn:hover{ transform: translateY(-1px); border-color: var(--accent); }
    .btn:active{ transform: translateY(1px); }

    .layout{
      display:grid;
      grid-template-columns: 320px 1fr;
      min-height: calc(100vh - 180px);
    }
    @media (max-width: 980px){
      .layout{ grid-template-columns: 1fr; }
      .sidebar{ position: static; border-right: none !important; }
    }

    nav.sidebar{
      border-right: 1px solid var(--border);
      background: var(--card2);
      padding: 0.85rem;
      position: sticky;
      top: 0;
      align-self: start;
      height: fit-content;
    }

    .search{
      display:flex;
      gap:0.4rem;
      align-items:center;
      border: 1px solid var(--border);
      background: var(--card);
      border-radius: var(--r-pill);
      padding: 0.35rem 0.75rem;
      margin-bottom: 0.7rem;
    }
    .search input{
      border:none;
      outline:none;
      background: transparent;
      color: var(--text);
      width: 100%;
      font-size: 0.88rem;
    }
    .search input::placeholder{ color: var(--muted); }

    .unitlist{
      display:flex;
      flex-direction:column;
      gap:0.45rem;
    }
    .unitlink{
      text-decoration:none;
      color: var(--text);
      border: 1px solid var(--border);
      background: var(--card);
      border-radius: var(--r-md);
      padding: 0.6rem 0.65rem;
      display:flex;
      flex-direction:column;
      gap:0.15rem;
      transition: transform .10s ease, border-color .12s ease;
    }
    .unitlink:hover{ transform: translateY(-2px); border-color: var(--accent); }
    .unitlink small{ color: var(--muted); font-size: 0.75rem; }

    main{
      padding: 1rem 1.05rem 1.2rem;
    }

    article.unit{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--r-lg);
      padding: 1rem 1.05rem;
      margin-bottom: 0.9rem;
    }

    .unit header{
      border: none;
      background: none;
      padding: 0;
      margin-bottom: 0.65rem;
    }

    .unit-title{
      display:flex;
      align-items:baseline;
      gap:0.6rem;
      flex-wrap:wrap;
    }
    .badge{
      border: 1px solid var(--border2);
      background: var(--accent2);
      color: var(--text);
      border-radius: var(--r-pill);
      padding: 0.18rem 0.55rem;
      font-size: 0.78rem;
    }
    .meta{
      color: var(--muted);
      font-size: 0.85rem;
      line-height: 1.35;
      margin-top: 0.25rem;
    }

    section.block{
      margin-top: 0.85rem;
      padding-top: 0.75rem;
      border-top: 1px dashed var(--border);
    }
    section.block h3{
      font-size: 1rem;
      margin-bottom: 0.35rem;
    }
    section.block p{
      color: var(--text);
      line-height: 1.55;
      font-size: 0.95rem;
      margin-bottom: 0.6rem;
    }
    ul, ol{
      padding-left: 1.2rem;
      margin: 0.45rem 0 0.7rem;
      color: var(--text);
      line-height: 1.55;
    }
    li{ margin: 0.22rem 0; }

    figure{
      margin: 0.8rem 0;
      border: 1px solid var(--border);
      border-radius: var(--r-md);
      overflow:hidden;
      background: var(--card2);
    }
    figure img{
      width:100%;
      display:block;
      max-height: 340px;
      object-fit: cover;
    }
    figcaption{
      padding: 0.55rem 0.7rem;
      color: var(--muted);
      font-size: 0.82rem;
    }

    details{
      margin-top: 0.55rem;
      border: 1px solid var(--border);
      border-radius: var(--r-md);
      background: var(--card2);
      padding: 0.55rem 0.7rem;
    }
    summary{
      cursor:pointer;
      font-weight: 650;
    }
    details p, details li{
      color: var(--text);
      font-weight: 400;
    }

    pre{
      background: var(--codebg);
      border: 1px solid var(--border);
      border-radius: var(--r-md);
      padding: 0.7rem 0.8rem;
      overflow:auto;
      margin: 0.65rem 0;
      font-family: var(--font-mono);
      font-size: 0.85rem;
      line-height: 1.45;
    }
    code{ font-family: var(--font-mono); }

    footer.app-footer{
      border-top: 1px solid var(--border);
      padding: 0.8rem 1.1rem;
      color: var(--muted);
      font-size: 0.82rem;
      display:flex;
      justify-content:space-between;
      flex-wrap:wrap;
      gap:0.4rem;
      background: var(--card2);
    }

    /* Print: deja la teor√≠a limpia */
    @media print{
      body{ background: #fff; padding:0; }
      .app{ box-shadow:none; border:none; border-radius:0; }
      nav.sidebar, .actions{ display:none !important; }
      header{ border-bottom: 1px solid #ddd; background:none; }
      article.unit{ break-inside: avoid; }
      a{ color: #000; text-decoration:none; }
    }
  </style>
</head>

<body>
  <div class="app">
    <header>
      <div class="topbar">
        <div class="brand">
          <div class="logo">TH</div>
          <div>
            <h1>Teor√≠a ‚Äì Material de clase (12 Unidades)</h1>
            <p class="subtitle">
              Navega por unidades, busca conceptos y ampl√≠a el temario a√±adiendo solo texto
              en la configuraci√≥n del archivo.
            </p>
          </div>
        </div>

        <div class="actions">
          <button class="btn" id="themeBtn" type="button" title="Cambiar tema">
            <span id="themeIcon">üåô</span><span id="themeLabel">Oscuro</span>
          </button>
          <button class="btn" id="printBtn" type="button" title="Imprimir / Guardar PDF">
            üñ®Ô∏è <span>Imprimir</span>
          </button>
        </div>
      </div>
    </header>

    <div class="layout">
      <nav class="sidebar" aria-label="√çndice de unidades">
        <div class="search" role="search">
          <span>‚åï</span>
          <input id="q" type="search" placeholder="Buscar en unidades‚Ä¶" aria-label="Buscar texto" />
        </div>

        <div class="unitlist" id="unitList">
          <!-- Links de unidades por JS -->
        </div>
      </nav>

      <main id="content" tabindex="-1">
        <!-- Unidades por JS -->
      </main>
    </div>

    <footer class="app-footer">
      <span>‚úÖ A√±adir una unidad = a√±adir un objeto con texto en <code>UNITS</code>.</span>
      <span>Tip: usa <strong>Ctrl+F</strong> o el buscador lateral para conceptos.</span>
    </footer>
  </div>

  <script>
    /*
      ‚úÖ C√ìMO A√ëADIR UNA UNIDAD (sin tocar HTML):
      1) Copia el objeto de la Unidad 1.
      2) Cambia id, title, summary y blocks (texto).
      3) Si quieres, a√±ade 'figure' con una imagen (ruta local).
      4) Listo: el √≠ndice y el contenido se generan solos.
    */

    const UNITS = [
      {
        id: "u1",
        number: 1,
        title: "Unidad 1 ‚Äî (Pon aqu√≠ el t√≠tulo real)",
        summary: "Introducci√≥n y fundamentos. (Descripci√≥n corta de la unidad en 1‚Äì2 l√≠neas).",
        blocks: [
          {
            h3: "1.1 Conceptos clave",
            p: [
              "Pega aqu√≠ tu teor√≠a en p√°rrafos. Puedes separar por ideas para que sea m√°s legible.",
              "Este bloque est√° pensado para texto principal: definiciones, contexto, objetivos y ejemplos."
            ],
            ul: [
              "Concepto A: definici√≥n breve",
              "Concepto B: idea importante",
              "Concepto C: ejemplo aplicado"
            ]
          },
          {
            h3: "1.2 Ejemplo / Caso pr√°ctico",
            p: [
              "Explica un caso real o un ejemplo guiado para que el alumnado conecte la teor√≠a con una situaci√≥n concreta."
            ],
            code: `Ejemplo (pseudoc√≥digo / f√≥rmula / fragmento):
entrada = "HOLA"
clave = 3
salida = cifrarCesar(entrada, clave)`
          },
          {
            h3: "1.3 Preguntas r√°pidas",
            p: ["Cierra con preguntas cortas para comprobar comprensi√≥n (ideal para Kahoot o mini-debate)."],
            ol: [
              "¬øQu√© diferencia hay entre X e Y?",
              "¬øQu√© debilidad tiene Z?",
              "¬øD√≥nde lo aplicar√≠as en un sistema real?"
            ]
          }
        ],
        figure: {
          // Opcional: si no quieres imagen, borra figure o d√©jalo en null.
          src: "img/unidad1_portada.jpg",
          alt: "Ilustraci√≥n unidad 1",
          caption: "Imagen de apoyo (puedes poner una portada por unidad)."
        },
        extras: [
          {
            title: "Ampliaci√≥n / Notas del profesor",
            p: [
              "Aqu√≠ puedes poner notas para ti: qu√© remarcar, errores t√≠picos, o qu√© ejercicio poner.",
              "Usa <details> para no saturar la teor√≠a principal."
            ]
          }
        ]
      }
    ];

    // ---------- Render ----------
    const unitList = document.getElementById("unitList");
    const content = document.getElementById("content");
    const q = document.getElementById("q");

    function esc(s){ return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m])); }

    function renderUnits(filterTerm = "") {
      const term = filterTerm.trim().toLowerCase();

      const filtered = !term ? UNITS : UNITS.filter(u => {
        const hay = [
          u.title, u.summary,
          ...(u.blocks||[]).flatMap(b => [b.h3, ...(b.p||[]), ...(b.ul||[]), ...(b.ol||[]), b.code||""])
        ].join(" ").toLowerCase();
        return hay.includes(term);
      });

      // Sidebar
      unitList.innerHTML = "";
      filtered.forEach(u => {
        const a = document.createElement("a");
        a.className = "unitlink";
        a.href = `#${u.id}`;
        a.innerHTML = `<strong>Unidad ${u.number}</strong><small>${esc(u.title.replace(/^Unidad\\s+\\d+\\s+‚Äî\\s*/i,""))}</small>`;
        unitList.appendChild(a);
      });

      // Content
      content.innerHTML = "";
      if (!filtered.length) {
        content.innerHTML = `<article class="unit"><header><div class="unit-title"><span class="badge">Sin resultados</span><h2 style="font-size:1.1rem;">No se encontr√≥ nada con ese texto</h2></div></header><p class="meta">Prueba con otra palabra clave.</p></article>`;
        return;
      }

      filtered.forEach(u => {
        const art = document.createElement("article");
        art.className = "unit";
        art.id = u.id;

        const titleClean = u.title || `Unidad ${u.number}`;
        const summary = u.summary || "";

        let figureHTML = "";
        if (u.figure && u.figure.src) {
          figureHTML = `
            <figure>
              <img src="${esc(u.figure.src)}" alt="${esc(u.figure.alt||"Imagen de unidad")}" loading="lazy">
              <figcaption>${esc(u.figure.caption||"")}</figcaption>
            </figure>
          `;
        }

        const blocksHTML = (u.blocks||[]).map(b => {
          const pHTML = (b.p||[]).map(t => `<p>${esc(t)}</p>`).join("");
          const ulHTML = b.ul?.length ? `<ul>${b.ul.map(li => `<li>${esc(li)}</li>`).join("")}</ul>` : "";
          const olHTML = b.ol?.length ? `<ol>${b.ol.map(li => `<li>${esc(li)}</li>`).join("")}</ol>` : "";
          const codeHTML = b.code ? `<pre><code>${esc(b.code)}</code></pre>` : "";
          return `
            <section class="block">
              <h3>${esc(b.h3||"")}</h3>
              ${pHTML}
              ${ulHTML}
              ${olHTML}
              ${codeHTML}
            </section>
          `;
        }).join("");

        const extrasHTML = (u.extras||[]).map(ex => {
          const exP = (ex.p||[]).map(t => `<p>${esc(t)}</p>`).join("");
          return `
            <details>
              <summary>${esc(ex.title||"Notas")}</summary>
              ${exP}
            </details>
          `;
        }).join("");

        art.innerHTML = `
          <header>
            <div class="unit-title">
              <span class="badge">Unidad ${u.number}</span>
              <h2 style="font-size:1.15rem;">${esc(titleClean.replace(/^Unidad\\s+\\d+\\s+‚Äî\\s*/i,""))}</h2>
            </div>
            <p class="meta">${esc(summary)}</p>
          </header>

          ${figureHTML}
          ${blocksHTML}
          ${extrasHTML}
        `;

        content.appendChild(art);
      });
    }

    renderUnits("");

    // ---------- Search ----------
    q.addEventListener("input", () => renderUnits(q.value));

    // ---------- Theme toggle ----------
    const THEME_KEY = "teoria-theme";
    const html = document.documentElement;
    const themeBtn = document.getElementById("themeBtn");
    const themeIcon = document.getElementById("themeIcon");
    const themeLabel = document.getElementById("themeLabel");

    function applyTheme(t){
      html.setAttribute("data-theme", t);
      if (t === "dark"){ themeIcon.textContent = "üåô"; themeLabel.textContent = "Oscuro"; }
      else { themeIcon.textContent = "‚òÄÔ∏è"; themeLabel.textContent = "Claro"; }
    }
    const stored = localStorage.getItem(THEME_KEY);
    applyTheme(stored === "light" ? "light" : "dark");

    themeBtn.addEventListener("click", () => {
      const next = html.getAttribute("data-theme") === "dark" ? "light" : "dark";
      applyTheme(next);
      localStorage.setItem(THEME_KEY, next);
    });

    // ---------- Print ----------
    document.getElementById("printBtn").addEventListener("click", () => window.print());
  </script>
</body>
</html>
